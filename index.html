
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¶…çº§å¤§è„‘</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #f5f5f7;
            margin: 0;
            padding: 40px 20px;
            min-height: 100vh;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            color: #1d1d1f;
            text-align: center;
            font-size: 56px;
            font-weight: 600;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            color: #6e6e73;
            text-align: center;
            font-size: 21px;
            line-height: 1.4;
            margin-bottom: 0;
        }

        h2 {
            color: #1d1d1f;
            margin-top: 60px;
            margin-bottom: 20px;
            font-size: 32px;
            font-weight: 600;
        }

        input[type="text"] {
            width: 100%;
            padding: 16px;
            margin: 10px 0;
            border: 1px solid #d2d2d7;
            border-radius: 12px;
            font-size: 17px;
            background-color: white;
            transition: all 0.3s ease;
            outline: none;
        }

        input[type="text"]:focus {
            border-color: #0071e3;
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
        }

        .save-btn {
            width: 100%;
            padding: 16px;
            margin: 16px 0;
            background-color: #0071e3;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .save-btn:hover {
            background-color: #0077ed;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 113, 227, 0.3);
        }

        .save-btn:active {
            transform: translateY(0);
        }

        /* æ ‡ç­¾é€‰æ‹©åŒºåŸŸ */
        .tag-selector {
            margin: 12px 0;
        }

        .tag-selector label {
            color: #1d1d1f;
            font-size: 16px;
            display: block;
            margin-bottom: 10px;
        }

        .tag-selector-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        /* é€šç”¨æ ‡ç­¾æŒ‰é’® */
        .tag-btn {
            padding: 8px 16px;
            background-color: white;
            color: #1d1d1f;
            border: 2px solid #d2d2d7;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 400;
            width: auto;
            margin: 0;
        }

        .tag-btn:hover {
            border-color: #0071e3;
            color: #0071e3;
            transform: none;
            box-shadow: none;
            background-color: white;
        }

        .tag-btn.selected {
            background-color: #0071e3;
            color: white;
            border-color: #0071e3;
        }

        .tag-btn.selected:hover {
            background-color: #0077ed;
            color: white;
        }

        /* æ”¶è—åˆ—è¡¨åŒºåŸŸ */
        #collections {
            background-color: white;
            padding: 32px;
            border-radius: 16px;
            margin-top: 20px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
        }

        /* ç­›é€‰æ  */
        #filterBar {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        /* æœç´¢æ¡†å®¹å™¨ */
        .search-container {
            margin-bottom: 20px;
        }

        .search-container input {
            margin: 0;
        }

        /* é“¾æ¥å¡ç‰‡ */
        .link-card {
            background-color: #f9f9f9;
            padding: 20px;
            margin: 12px 0;
            border-radius: 12px;
            border-left: 4px solid #0071e3;
            transition: all 0.3s ease;
        }

        .link-card:hover {
            background-color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .link-card h3 {
            margin: 0 0 10px 0;
            color: #1d1d1f;
            font-size: 18px;
        }

        .link-card .link-url {
            margin: 5px 0;
            word-break: break-all;
        }

        .link-card .link-url a {
            color: #0071e3;
            text-decoration: none;
        }

        .link-card .link-note {
            margin: 10px 0 0 0;
            color: #6e6e73;
        }

        .link-card .link-time {
            margin: 10px 0 0 0;
            color: #999;
            font-size: 14px;
        }

        .link-card .card-tag {
            display: inline-block;
            padding: 4px 12px;
            background-color: #e3f2fd;
            color: #0071e3;
            border-radius: 12px;
            font-size: 13px;
            margin-top: 8px;
        }

        .card-actions {
            margin-top: 12px;
            display: flex;
            gap: 8px;
        }

        .edit-btn {
            padding: 8px 16px;
            background-color: #0071e3;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            width: auto;
            margin: 0;
            transition: all 0.2s ease;
        }

        .edit-btn:hover {
            background-color: #0077ed;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 113, 227, 0.3);
        }

        .delete-btn {
            padding: 8px 16px;
            background-color: #ff3b30;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            width: auto;
            margin: 0;
            transition: all 0.2s ease;
        }

        .delete-btn:hover {
            background-color: #ff2d20;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(255, 59, 48, 0.3);
        }

        /* ç©ºçŠ¶æ€ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6e6e73;
        }

        .empty-state .empty-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }

        .empty-state .empty-title {
            font-size: 20px;
            color: #1d1d1f;
            margin-bottom: 8px;
            text-align: center;
        }

        .empty-state .empty-desc {
            font-size: 16px;
            text-align: center;
        }

        /* é«˜äº® */
        .highlight {
            background-color: #fff59d;
            padding: 2px 4px;
            border-radius: 3px;
        }
            /* æ·±è‰²æ¨¡å¼æ ·å¼ */
            body.dark-mode {
                background-color: #18191a;
                color: #e4e6eb;
            }
            body.dark-mode h1,
            body.dark-mode h2,
            body.dark-mode .empty-state .empty-title {
                color: #e4e6eb;
            }
            body.dark-mode .subtitle {
                color: #b0b3b8;
            }
            body.dark-mode input[type="text"] {
                background-color: #242526;
                color: #e4e6eb;
                border-color: #3a3b3c;
            }
            body.dark-mode input[type="text"]:focus {
                border-color: #4e8cff;
                box-shadow: 0 0 0 4px rgba(78, 140, 255, 0.1);
            }
            body.dark-mode .save-btn {
                background-color: #4e8cff;
                color: #fff;
            }
            body.dark-mode .save-btn:hover {
                background-color: #357ae8;
            }
            body.dark-mode .tag-btn {
                background-color: #242526;
                color: #e4e6eb;
                border-color: #3a3b3c;
            }
            body.dark-mode .tag-btn.selected {
                background-color: #4e8cff;
                color: #fff;
                border-color: #4e8cff;
            }
            body.dark-mode #collections {
                background-color: #242526;
                box-shadow: 0 4px 16px rgba(0,0,0,0.3);
            }
            body.dark-mode .link-card {
                background-color: #23272f;
                border-left: 4px solid #4e8cff;
            }
            body.dark-mode .link-card:hover {
                background-color: #242526;
            }
            body.dark-mode .link-card h3 {
                color: #e4e6eb;
            }
            body.dark-mode .link-card .link-note {
                color: #b0b3b8;
            }
            body.dark-mode .link-card .link-time {
                color: #888;
            }
            body.dark-mode .link-card .card-tag {
                background-color: #2d3a4a;
                color: #4e8cff;
            }
            body.dark-mode .edit-btn {
                background-color: #4e8cff;
            }
            body.dark-mode .edit-btn:hover {
                background-color: #357ae8;
            }
            body.dark-mode .delete-btn {
                background-color: #ff3b30;
            }
            body.dark-mode .delete-btn:hover {
                background-color: #c62828;
            }
            body.dark-mode .empty-state {
                color: #b0b3b8;
            }
            body.dark-mode .highlight {
                background-color: #3a3b3c;
            }
    </style>
</head>
<body>
    <!-- æ·±è‰²æ¨¡å¼åˆ‡æ¢æŒ‰é’® -->
    <div style="position: fixed; top: 18px; right: 24px; z-index: 999;">
        <button id="darkModeToggle" style="padding: 8px 18px; border-radius: 20px; border: none; background: #222; color: #fff; font-size: 15px; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.12);">ğŸŒ™ æ·±è‰²æ¨¡å¼</button>
    </div>
    <div class="container">
        <h1>è¶…çº§å¤§è„‘ ğŸš€</h1>
        <p class="subtitle">æ¬¢è¿ä½¿ç”¨æˆ‘çš„é“¾æ¥æ”¶è—å·¥å…·ï¼åœ¨è¿™é‡Œæ•´ç†ä½ çš„çŸ¥è¯†ã€‚</p>

        <h2>æ·»åŠ æ–°é“¾æ¥</h2>
        <div class="add-form">
            <input type="text" id="inputUrl" placeholder="è¾“å…¥ç½‘é¡µé“¾æ¥ï¼ˆå¦‚ï¼šhttps://example.comï¼‰">
            <input type="text" id="inputTitle" placeholder="è¾“å…¥é“¾æ¥æ ‡é¢˜">
            <input type="text" id="inputNote" placeholder="æ·»åŠ ç¬”è®°ï¼ˆå¯é€‰ï¼‰">

            <div class="tag-selector">
                <label>ğŸ·ï¸ é€‰æ‹©æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰ï¼š</label>
                <div class="tag-selector-buttons" id="addTagButtons">
                    <button class="tag-btn" data-tag="ç¼–ç¨‹">ç¼–ç¨‹</button>
                    <button class="tag-btn" data-tag="è®¾è®¡">è®¾è®¡</button>
                    <button class="tag-btn" data-tag="AI">AI</button>
                    <button class="tag-btn" data-tag="å­¦ä¹ ">å­¦ä¹ </button>
                    <button class="tag-btn" data-tag="å·¥ä½œ">å·¥ä½œ</button>
                    <button class="tag-btn" data-tag="å·¥å…·">å·¥å…·</button>
                    <button class="tag-btn" data-tag="å…¶ä»–">å…¶ä»–</button>
                </div>
            </div>

            <button class="save-btn" id="saveBtn">+ âœ¨ ç«‹å³æ”¶è—</button>
        </div>

        <h2>
            æˆ‘çš„æ”¶è— ğŸ“š
            <span id="countLabel" style="color: #0071e3; font-size: 24px; font-weight: 400;"></span>
        </h2>

        <!-- å·¥å…·æ  -->
        <div style="
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        ">
            <button class="save-btn" id="exportBtn" style="
                flex: 1;
                min-width: 140px;
                background-color: #34c759;
                margin: 0;
                padding: 12px 20px;
                font-size: 15px;
            ">
                ğŸ“¤ å¯¼å‡ºæ•°æ®
            </button>
            <button class="save-btn" id="importBtn" style="
                flex: 1;
                min-width: 140px;
                background-color: #ff9500;
                margin: 0;
                padding: 12px 20px;
                font-size: 15px;
            ">
                ğŸ“¥ å¯¼å…¥æ•°æ®
            </button>
        </div>
        <!-- éšè—çš„æ–‡ä»¶è¾“å…¥æ¡†ï¼ˆç”¨äºå¯¼å…¥ï¼‰ -->
        <input type="file" id="importFile" accept=".json" style="display: none;">

        <div id="collections">
            <!-- æ ‡ç­¾ç­›é€‰æ  -->
            <div id="filterBar"></div>

            <!-- æœç´¢æ¡† -->
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="ğŸ” æœç´¢é“¾æ¥ï¼ˆæ ‡é¢˜ã€URLã€ç¬”è®°...ï¼‰">
            </div>

            <!-- é“¾æ¥åˆ—è¡¨ -->
            <div id="linkList"></div>
        </div>
    </div>

    <script>
        // æ·±è‰²æ¨¡å¼åˆ‡æ¢é€»è¾‘
        const darkModeToggle = document.getElementById('darkModeToggle');
        function setDarkMode(enabled) {
            if (enabled) {
                document.body.classList.add('dark-mode');
                darkModeToggle.textContent = 'â˜€ï¸ æµ…è‰²æ¨¡å¼';
            } else {
                document.body.classList.remove('dark-mode');
                darkModeToggle.textContent = 'ğŸŒ™ æ·±è‰²æ¨¡å¼';
            }
            localStorage.setItem('darkMode', enabled ? '1' : '0');
        }
        // åˆå§‹åŒ–æ·±è‰²æ¨¡å¼çŠ¶æ€
        (function() {
            const saved = localStorage.getItem('darkMode');
            if (saved === '1' || (saved === null && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                setDarkMode(true);
            } else {
                setDarkMode(false);
            }
        })();
        darkModeToggle.onclick = function() {
            setDarkMode(!document.body.classList.contains('dark-mode'));
        };
        // ==========================================
        // æ•°æ®å’ŒçŠ¶æ€
        // ==========================================
        let links = JSON.parse(localStorage.getItem('myLinks') || '[]');
        let selectedAddTag = '';    // æ·»åŠ è¡¨å•ä¸­é€‰ä¸­çš„æ ‡ç­¾
        let activeFilter = 'å…¨éƒ¨';  // å½“å‰ç­›é€‰æ ‡ç­¾
        let searchKeyword = '';     // å½“å‰æœç´¢å…³é”®è¯

        // ==========================================
        // è·å– DOM å…ƒç´ 
        // ==========================================
        const inputUrl = document.getElementById('inputUrl');
        const inputTitle = document.getElementById('inputTitle');
        const inputNote = document.getElementById('inputNote');
        const saveBtn = document.getElementById('saveBtn');
        const addTagButtons = document.querySelectorAll('#addTagButtons .tag-btn');
        const countLabel = document.getElementById('countLabel');
        const filterBar = document.getElementById('filterBar');
        const searchInput = document.getElementById('searchInput');
        const linkList = document.getElementById('linkList');

        // ==========================================
        // æ·»åŠ è¡¨å• - æ ‡ç­¾é€‰æ‹©
        // ==========================================
        addTagButtons.forEach(function(btn) {
            btn.onclick = function() {
                if (selectedAddTag === this.dataset.tag) {
                    // å–æ¶ˆé€‰ä¸­
                    selectedAddTag = '';
                    this.classList.remove('selected');
                } else {
                    // é€‰ä¸­æ–°æ ‡ç­¾
                    addTagButtons.forEach(b => b.classList.remove('selected'));
                    selectedAddTag = this.dataset.tag;
                    this.classList.add('selected');
                }
            };
        });

        // ==========================================
        // ä¿å­˜é“¾æ¥
        // ==========================================
        saveBtn.onclick = function() {
            const url = inputUrl.value.trim();
            const title = inputTitle.value.trim();
            const note = inputNote.value.trim();

            if (!url || !title) {
                alert('è¯·è‡³å°‘å¡«å†™é“¾æ¥å’Œæ ‡é¢˜ï¼');
                return;
            }

            const newLink = {
                id: Date.now(),
                url: url,
                title: title,
                note: note,
                tag: selectedAddTag,
                time: new Date().toLocaleString('zh-CN')
            };

            links.unshift(newLink);
            saveToStorage();

            // æ¸…ç©ºè¡¨å•
            inputUrl.value = '';
            inputTitle.value = '';
            inputNote.value = '';
            selectedAddTag = '';
            addTagButtons.forEach(b => b.classList.remove('selected'));

            // é‡ç½®ç­›é€‰ï¼Œæ˜¾ç¤ºæœ€æ–°
            activeFilter = 'å…¨éƒ¨';
            searchInput.value = '';
            searchKeyword = '';

            renderAll();
            console.log('âœ… é“¾æ¥å·²ä¿å­˜ï¼');
        };

        // ==========================================
        // æœç´¢
        // ==========================================
        searchInput.oninput = function() {
            searchKeyword = this.value.trim().toLowerCase();
            renderLinkList();
        };

        // ==========================================
        // ä¿å­˜åˆ° localStorage
        // ==========================================
        function saveToStorage() {
            localStorage.setItem('myLinks', JSON.stringify(links));
        }

        // ==========================================
        // æ¸²æŸ“æ‰€æœ‰ï¼ˆç­›é€‰æ  + åˆ—è¡¨ï¼‰
        // ==========================================
        function renderAll() {
            renderFilterBar();
            renderLinkList();
        }

        // ==========================================
        // æ¸²æŸ“æ ‡ç­¾ç­›é€‰æ 
        // ==========================================
        function renderFilterBar() {
            // æ”¶é›†æ‰€æœ‰å·²ä½¿ç”¨çš„æ ‡ç­¾
            const usedTags = [];
            links.forEach(function(link) {
                if (link.tag && !usedTags.includes(link.tag)) {
                    usedTags.push(link.tag);
                }
            });

            // æ²¡æœ‰æ ‡ç­¾å°±éšè—ç­›é€‰æ 
            if (usedTags.length === 0) {
                filterBar.innerHTML = '';
                return;
            }

            let html = '';

            // "å…¨éƒ¨"æŒ‰é’®
            const allClass = activeFilter === 'å…¨éƒ¨' ? 'tag-btn selected' : 'tag-btn';
            html += `<button class="${allClass}" onclick="setFilter('å…¨éƒ¨')">
                        ğŸ“š å…¨éƒ¨ï¼ˆ${links.length}ï¼‰
                     </button>`;

            // å„æ ‡ç­¾æŒ‰é’®
            usedTags.forEach(function(tag) {
                const count = links.filter(l => l.tag === tag).length;
                const btnClass = activeFilter === tag ? 'tag-btn selected' : 'tag-btn';
                html += `<button class="${btnClass}" onclick="setFilter('${tag}')">
                            ğŸ·ï¸ ${tag}ï¼ˆ${count}ï¼‰
                         </button>`;
            });

            filterBar.innerHTML = html;
        }

        // ==========================================
        // è®¾ç½®ç­›é€‰æ ‡ç­¾
        // ==========================================
        function setFilter(tag) {
            activeFilter = tag;
            searchInput.value = '';
            searchKeyword = '';
            renderAll();
        }

        // ==========================================
        // æ¸²æŸ“é“¾æ¥åˆ—è¡¨
        // ==========================================
        function renderLinkList() {
            // æ›´æ–°è®¡æ•°
            updateCount();

            // ç¬¬ä¸€æ­¥ï¼šæŒ‰æ ‡ç­¾ç­›é€‰
            let result = links;
            if (activeFilter !== 'å…¨éƒ¨') {
                result = links.filter(l => l.tag === activeFilter);
            }

            // ç¬¬äºŒæ­¥ï¼šæŒ‰å…³é”®è¯æœç´¢
            if (searchKeyword) {
                result = result.filter(function(link) {
                    return (link.title && link.title.toLowerCase().includes(searchKeyword)) ||
                           (link.url && link.url.toLowerCase().includes(searchKeyword)) ||
                           (link.note && link.note.toLowerCase().includes(searchKeyword));
                });
            }

            // ç©ºçŠ¶æ€
            if (result.length === 0) {
                if (links.length === 0) {
                    linkList.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ“š</div>
                            <p class="empty-title">è¿˜æ²¡æœ‰ä»»ä½•æ”¶è—</p>
                            <p class="empty-desc">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ï¼Œå¼€å§‹æ•´ç†ä½ çš„çŸ¥è¯†åº“å§ï¼</p>
                        </div>`;
                } else {
                    linkList.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ”</div>
                            <p class="empty-title">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„é“¾æ¥</p>
                            <p class="empty-desc">è¯•è¯•å…¶ä»–å…³é”®è¯æˆ–æ ‡ç­¾ï½</p>
                        </div>`;
                }
                return;
            }

            // æ¸²æŸ“å¡ç‰‡
            let html = '';
            result.forEach(function(link) {
                const realIndex = links.indexOf(link);
                const tagHTML = link.tag
                    ? `<span class="card-tag">ğŸ·ï¸ ${link.tag}</span>`
                    : '';

                const title = searchKeyword ? highlight(link.title, searchKeyword) : escapeHTML(link.title);
                const url = searchKeyword ? highlight(link.url, searchKeyword) : escapeHTML(link.url);
                const note = searchKeyword ? highlight(link.note, searchKeyword) : escapeHTML(link.note);

                html += `
                    <div class="link-card">
                        <h3>ğŸ“ ${title}</h3>
                        <p class="link-url">
                            ğŸ”— <a href="${escapeHTML(link.url)}" target="_blank">${url}</a>
                        </p>
                        <p class="link-note">ğŸ“ ${note || 'ï¼ˆæ— ç¬”è®°ï¼‰'}</p>
                        ${tagHTML}
                        <p class="link-time">ğŸ•’ ${link.time}</p>
                        <div class="card-actions">
                            <button class="edit-btn" onclick="editLink(${realIndex})">âœï¸ ç¼–è¾‘</button>
                            <button class="delete-btn" onclick="deleteLink(${realIndex})">ğŸ—‘ï¸ åˆ é™¤</button>
                        </div>
                    </div>`;
            });

            linkList.innerHTML = html;
        }

        // ==========================================
        // æ›´æ–°è®¡æ•°
        // ==========================================
        function updateCount() {
            let filtered = links;
            if (activeFilter !== 'å…¨éƒ¨') {
                filtered = links.filter(l => l.tag === activeFilter);
            }
            if (searchKeyword) {
                filtered = filtered.filter(function(link) {
                    return (link.title && link.title.toLowerCase().includes(searchKeyword)) ||
                           (link.url && link.url.toLowerCase().includes(searchKeyword)) ||
                           (link.note && link.note.toLowerCase().includes(searchKeyword));
                });
            }

            if (filtered.length === links.length) {
                countLabel.textContent = `ï¼ˆå…± ${links.length} ä¸ªï¼‰`;
            } else {
                countLabel.textContent = `ï¼ˆå…± ${links.length} ä¸ªï¼Œæ˜¾ç¤º ${filtered.length} ä¸ªï¼‰`;
            }
        }

        // ==========================================
        // åˆ é™¤é“¾æ¥
        // ==========================================
        function deleteLink(index) {
            const link = links[index];
            if (confirm(`ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé“¾æ¥å—ï¼Ÿ\n\nğŸ“ ${link.title}`)) {
                links.splice(index, 1);
                saveToStorage();
                activeFilter = 'å…¨éƒ¨';
                renderAll();
                console.log('ğŸ—‘ï¸ é“¾æ¥å·²åˆ é™¤ï¼');
            }
        }

        // ==========================================
        // ç¼–è¾‘é“¾æ¥
        // ==========================================
        function editLink(index) {
            const link = links[index];

            inputUrl.value = link.url;
            inputTitle.value = link.title;
            inputNote.value = link.note || '';

            // æ¢å¤æ ‡ç­¾é€‰ä¸­çŠ¶æ€
            selectedAddTag = link.tag || '';
            addTagButtons.forEach(function(btn) {
                btn.classList.toggle('selected', btn.dataset.tag === selectedAddTag);
            });

            // åˆ é™¤åŸè®°å½•
            links.splice(index, 1);
            saveToStorage();
            activeFilter = 'å…¨éƒ¨';
            renderAll();

            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            window.scrollTo({ top: 0, behavior: 'smooth' });
            alert('å†…å®¹å·²å¡«å……åˆ°è¾“å…¥æ¡†ï¼Œä¿®æ”¹åç‚¹å‡»"ç«‹å³æ”¶è—"å®Œæˆç¼–è¾‘ï¼');
        }

        // ==========================================
        // å·¥å…·å‡½æ•°ï¼šé«˜äº®å…³é”®è¯
        // ==========================================
        function highlight(text, keyword) {
            if (!text || !keyword) return escapeHTML(text || '');
            const escaped = escapeHTML(text);
            const escapedKeyword = keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            const regex = new RegExp(`(${escapedKeyword})`, 'gi');
            return escaped.replace(regex, '<span class="highlight">$1</span>');
        }

        // ==========================================
        // å·¥å…·å‡½æ•°ï¼šè½¬ä¹‰ HTML
        // ==========================================
        function escapeHTML(str) {
            if (!str) return '';
            return str
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;');
        }

        // ==========================================
        // å¯¼å‡ºæ•°æ®
        // ==========================================
        document.getElementById('exportBtn').onclick = function() {
            if (links.length === 0) {
                alert('è¿˜æ²¡æœ‰ä»»ä½•é“¾æ¥å¯ä»¥å¯¼å‡ºï¼');
                return;
            }

            // æŠŠæ•°æ®è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²ï¼ˆæ ¼å¼åŒ–ï¼Œæ–¹ä¾¿é˜…è¯»ï¼‰
            const jsonData = JSON.stringify(links, null, 2);

            // åˆ›å»ºä¸€ä¸ªä¸‹è½½é“¾æ¥
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);

            // è‡ªåŠ¨ç‚¹å‡»ä¸‹è½½
            const a = document.createElement('a');
            a.href = url;
            a.download = `è¶…çº§å¤§è„‘å¤‡ä»½_${new Date().toLocaleDateString('zh-CN').replace(/\//g, '-')}.json`;
            a.click();

            // æ¸…ç†
            URL.revokeObjectURL(url);

            console.log(`âœ… å·²å¯¼å‡º ${links.length} ä¸ªé“¾æ¥`);
        };

        // ==========================================
        // å¯¼å…¥æ•°æ®
        // ==========================================
        document.getElementById('importBtn').onclick = function() {
            document.getElementById('importFile').click();
        };

        document.getElementById('importFile').onchange = function(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();

            reader.onload = function(e) {
                try {
                    // è§£æ JSON æ–‡ä»¶
                    const importedLinks = JSON.parse(e.target.result);

                    // éªŒè¯æ•°æ®æ ¼å¼
                    if (!Array.isArray(importedLinks)) {
                        alert('æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®ï¼è¯·é€‰æ‹©æ­£ç¡®çš„å¤‡ä»½æ–‡ä»¶ã€‚');
                        return;
                    }

                    // è¯¢é—®å¯¼å…¥æ–¹å¼
                    const choice = confirm(
                        `æ–‡ä»¶ä¸­æœ‰ ${importedLinks.length} ä¸ªé“¾æ¥\n\n` +
                        `ç‚¹å‡»"ç¡®å®š"ï¼šåˆå¹¶åˆ°ç°æœ‰æ•°æ®ï¼ˆæ¨èï¼‰\n` +
                        `ç‚¹å‡»"å–æ¶ˆ"ï¼šæ›¿æ¢æ‰€æœ‰ç°æœ‰æ•°æ®`
                    );

                    if (choice) {
                        // åˆå¹¶ï¼ˆé¿å…é‡å¤ï¼‰
                        let addedCount = 0;
                        importedLinks.forEach(function(importedLink) {
                            const exists = links.some(l => l.url === importedLink.url);
                            if (!exists) {
                                links.push(importedLink);
                                addedCount++;
                            }
                        });
                        alert(`âœ… å¯¼å…¥å®Œæˆï¼æ–°å¢äº† ${addedCount} ä¸ªé“¾æ¥`);
                    } else {
                        // æ›¿æ¢
                        links = importedLinks;
                        alert(`âœ… å¯¼å…¥å®Œæˆï¼å…± ${links.length} ä¸ªé“¾æ¥`);
                    }

                    // ä¿å­˜å¹¶åˆ·æ–°
                    saveToStorage();
                    activeFilter = 'å…¨éƒ¨';
                    renderAll();

                } catch (error) {
                    alert('æ–‡ä»¶è§£æå¤±è´¥ï¼è¯·ç¡®è®¤æ˜¯å¦ä¸ºæ­£ç¡®çš„ JSON å¤‡ä»½æ–‡ä»¶ã€‚');
                    console.error('å¯¼å…¥é”™è¯¯ï¼š', error);
                }
            };

            reader.readAsText(file);

            // é‡ç½®æ–‡ä»¶è¾“å…¥æ¡†ï¼ˆå…è®¸é‡å¤å¯¼å…¥åŒä¸€æ–‡ä»¶ï¼‰
            this.value = '';
        };
        // ==========================================
        // åˆå§‹åŒ–
        // ==========================================
        renderAll();
        console.log(`ğŸš€ è¶…çº§å¤§è„‘å·²åŠ è½½ï¼å…± ${links.length} ä¸ªé“¾æ¥`);
    </script>
</body>
</html>